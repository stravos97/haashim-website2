---
import Layout from '../layouts/Layout.astro';
import { cvData } from '../data/cvData';

const { personal, skills, experience, projects, education, certifications } = cvData;
---

<Layout title={`${personal.name} - ${personal.title}`}>
  <div class="govuk-width-container">
    <!-- Skip to main content link for accessibility -->
    <a href="#main-content" class="govuk-skip-link">Skip to main content</a>
    
    <!-- Header with contact info -->
    <header class="govuk-header" role="banner">
      <div class="govuk-header__content">
        <h1 class="govuk-heading-xl">{personal.name}</h1>
        <p class="govuk-body-l govuk-!-margin-bottom-4">{personal.title}</p>
        <p class="govuk-body govuk-!-margin-bottom-6">{personal.summary}</p>
        
        <div class="govuk-button-group">
          <a href={`mailto:${personal.contact.email}`} class="govuk-link">
            Email: {personal.contact.email}
          </a>
          <span class="govuk-!-margin-left-3 govuk-!-margin-right-3">|</span>
          <a href={`tel:${personal.contact.phone.replace(/\s/g, '')}`} class="govuk-link">
            Phone: {personal.contact.phone}
          </a>
          <span class="govuk-!-margin-left-3 govuk-!-margin-right-3">|</span>
          <a href={`https://${personal.contact.linkedin}`} class="govuk-link">
            LinkedIn
          </a>
          <span class="govuk-!-margin-left-3 govuk-!-margin-right-3">|</span>
          <a href={`https://${personal.contact.github}`} class="govuk-link">
            GitHub
          </a>
        </div>
      </div>
    </header>

    <!-- Main content -->
    <main class="govuk-main-wrapper" id="main-content" role="main">
      
      <!-- Professional Experience -->
      <section class="govuk-section" aria-labelledby="experience-heading">
        <h2 class="govuk-heading-l" id="experience-heading">Professional experience</h2>
        
        {experience.map((exp) => (
          <article class="govuk-!-margin-bottom-8">
            <h3 class="govuk-heading-m govuk-!-margin-bottom-2">
              {exp.title}
            </h3>
            <p class="govuk-body govuk-!-font-weight-bold govuk-!-margin-bottom-1">
              {exp.company}
            </p>
            <p class="govuk-body-s govuk-text-colour--secondary govuk-!-margin-bottom-4">
              {exp.period} • {exp.location}
            </p>
            <ul class="govuk-list govuk-list--bullet">
              {exp.points.map((point) => (
                <li>{point}</li>
              ))}
            </ul>
          </article>
        ))}
      </section>

      <!-- Key Projects -->
      <section class="govuk-section" aria-labelledby="projects-heading">
        <h2 class="govuk-heading-l" id="projects-heading">Key projects</h2>
        
        {projects.map((project) => (
          <article class="govuk-!-margin-bottom-7">
            <h3 class="govuk-heading-m govuk-!-margin-bottom-2">
              {project.name}
            </h3>
            <p class="govuk-body govuk-!-margin-bottom-3">
              {project.description}
            </p>
            
            <div class="govuk-!-margin-bottom-3">
              <p class="govuk-body-s govuk-!-font-weight-bold govuk-!-margin-bottom-2">
                Technologies used:
              </p>
              <div class="govuk-tag-list">
                {project.techStack.map((tech) => (
                  <span class="govuk-tag govuk-tag--grey">{tech}</span>
                ))}
              </div>
            </div>
            
            {project.achievements.length > 0 && (
              <div>
                <p class="govuk-body-s govuk-!-font-weight-bold govuk-!-margin-bottom-2">
                  Key achievements:
                </p>
                <ul class="govuk-list govuk-list--bullet govuk-list--spaced">
                  {project.achievements.map((achievement) => (
                    <li class="govuk-body-s">{achievement}</li>
                  ))}
                </ul>
              </div>
            )}
            
            {project.metrics && project.metrics.length > 0 && (
              <div class="govuk-inset-text govuk-!-margin-top-3">
                {project.metrics.map((metric) => (
                  <p class="govuk-body-s govuk-!-margin-bottom-1">{metric}</p>
                ))}
              </div>
            )}
          </article>
        ))}
      </section>

      <!-- Technical Skills -->
      <section class="govuk-section" aria-labelledby="skills-heading">
        <h2 class="govuk-heading-l" id="skills-heading">Technical skills</h2>
        
        <div class="govuk-grid-row">
          {Object.entries(skills).map(([category, skillList]) => (
            <div class="govuk-grid-column-one-half govuk-!-margin-bottom-6">
              <h3 class="govuk-heading-s govuk-!-margin-bottom-3">{category}</h3>
              <div class="govuk-tag-list">
                {skillList.map((skill) => (
                  <span class="govuk-tag govuk-tag--blue">{skill}</span>
                ))}
              </div>
            </div>
          ))}
        </div>
      </section>

      <!-- Education -->
      <section class="govuk-section" aria-labelledby="education-heading">
        <h2 class="govuk-heading-l" id="education-heading">Education</h2>
        
        {education.map((edu) => (
          <article class="govuk-!-margin-bottom-6">
            <h3 class="govuk-heading-m govuk-!-margin-bottom-2">
              {edu.degree}
            </h3>
            <p class="govuk-body govuk-!-font-weight-bold govuk-!-margin-bottom-1">
              {edu.institution}
            </p>
            <p class="govuk-body-s govuk-text-colour--secondary govuk-!-margin-bottom-3">
              {edu.period} • {edu.location}
            </p>
            {edu.grade && (
              <p class="govuk-body govuk-!-margin-bottom-3">
                <strong>Grade:</strong> {edu.grade}
              </p>
            )}
            {edu.modules && edu.modules.length > 0 && (
              <details class="govuk-details" data-module="govuk-details">
                <summary class="govuk-details__summary">
                  <span class="govuk-details__summary-text">
                    Key modules studied
                  </span>
                </summary>
                <div class="govuk-details__text">
                  <ul class="govuk-list govuk-list--bullet">
                    {edu.modules.map((module) => (
                      <li>{module}</li>
                    ))}
                  </ul>
                </div>
              </details>
            )}
          </article>
        ))}
      </section>

      <!-- Certifications -->
      {certifications && certifications.length > 0 && (
        <section class="govuk-section" aria-labelledby="certifications-heading">
          <h2 class="govuk-heading-l" id="certifications-heading">Certifications</h2>
          
          <ul class="govuk-list govuk-list--bullet">
            {certifications.map((cert) => (
              <li class="govuk-!-margin-bottom-2">{cert}</li>
            ))}
          </ul>
        </section>
      )}
    </main>

    <!-- Footer -->
    <footer class="govuk-footer" role="contentinfo">
      <div class="govuk-footer__meta">
        <div class="govuk-footer__meta-item">
          <p class="govuk-footer__copyright">
            © 2024 {personal.name}
          </p>
        </div>
        <div class="govuk-footer__meta-item">
          <button class="govuk-button govuk-button--secondary" onclick="window.print()">
            Print this CV
          </button>
        </div>
      </div>
    </footer>
  </div>
</Layout>

<style>
  /* GOV.UK Component Styles */
  .govuk-width-container {
    max-width: 1020px;
    margin: 0 auto;
    padding: 0 15px;
  }

  .govuk-skip-link {
    position: absolute;
    left: -9999px;
    z-index: 999;
    padding: 10px 15px;
    background: var(--color-focus);
    color: var(--color-text);
    text-decoration: none;
    font-weight: 700;
  }

  .govuk-skip-link:focus {
    left: 0;
  }

  .govuk-header {
    padding: var(--spacing-6) 0;
    border-bottom: 10px solid var(--color-primary);
    margin-bottom: var(--spacing-6);
  }

  .govuk-heading-xl {
    font-size: var(--font-size-48);
    font-weight: 700;
    margin: 0 0 var(--spacing-4) 0;
    line-height: var(--line-height-tight);
  }

  .govuk-heading-l {
    font-size: var(--font-size-36);
    font-weight: 700;
    margin: var(--spacing-8) 0 var(--spacing-4) 0;
    line-height: var(--line-height-tight);
  }

  .govuk-heading-m {
    font-size: var(--font-size-24);
    font-weight: 700;
    margin: var(--spacing-6) 0 var(--spacing-3) 0;
    line-height: var(--line-height-tight);
  }

  .govuk-heading-s {
    font-size: var(--font-size-19);
    font-weight: 700;
    margin: var(--spacing-4) 0 var(--spacing-2) 0;
    line-height: var(--line-height-tight);
  }

  .govuk-body {
    font-size: var(--font-size-19);
    line-height: var(--line-height-normal);
    margin-bottom: var(--spacing-3);
  }

  .govuk-body-l {
    font-size: var(--font-size-24);
    line-height: var(--line-height-normal);
    margin-bottom: var(--spacing-4);
  }

  .govuk-body-s {
    font-size: var(--font-size-16);
    line-height: var(--line-height-normal);
    margin-bottom: var(--spacing-2);
  }

  .govuk-link {
    color: var(--color-link);
    text-underline-offset: 0.1em;
  }

  .govuk-link:visited {
    color: var(--color-link-visited);
  }

  .govuk-link:hover {
    color: var(--color-link-hover);
    text-decoration-thickness: 3px;
  }

  .govuk-link:focus {
    background-color: var(--color-focus);
    color: var(--color-text);
    outline: var(--focus-width) solid var(--color-focus);
    outline-offset: 0;
    text-decoration: none;
    box-shadow: 0 -2px var(--color-focus), 0 4px var(--color-text);
  }

  .govuk-list {
    padding-left: 20px;
    margin-bottom: var(--spacing-4);
  }

  .govuk-list--bullet {
    list-style-type: disc;
  }

  .govuk-list--spaced li {
    margin-bottom: var(--spacing-2);
  }

  .govuk-section {
    margin-bottom: var(--spacing-8);
    padding-bottom: var(--spacing-6);
    border-bottom: 1px solid var(--color-border);
  }

  .govuk-section:last-child {
    border-bottom: none;
  }

  .govuk-button-group {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0;
  }

  .govuk-tag {
    display: inline-block;
    padding: 4px 8px;
    margin-right: var(--spacing-2);
    margin-bottom: var(--spacing-2);
    font-size: var(--font-size-16);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    border: 2px solid currentColor;
  }

  .govuk-tag--blue {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
  }

  .govuk-tag--grey {
    background: var(--color-bg-secondary);
    color: var(--color-text);
    border-color: var(--color-border);
  }

  .govuk-tag-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0;
  }

  .govuk-inset-text {
    padding: var(--spacing-3);
    border-left: 5px solid var(--color-border);
    background: var(--color-bg-secondary);
  }

  .govuk-details {
    margin-bottom: var(--spacing-4);
  }

  .govuk-details__summary {
    cursor: pointer;
    color: var(--color-link);
    text-underline-offset: 0.1em;
    display: inline-block;
    padding: var(--spacing-2) 0;
  }

  .govuk-details__summary:hover {
    color: var(--color-link-hover);
    text-decoration-thickness: 3px;
  }

  .govuk-details__summary:focus {
    outline: var(--focus-width) solid var(--color-focus);
    outline-offset: 0;
    background-color: var(--color-focus);
    color: var(--color-text);
  }

  .govuk-details__text {
    padding: var(--spacing-3) 0 var(--spacing-3) var(--spacing-4);
    border-left: 5px solid var(--color-border);
  }

  .govuk-footer {
    padding: var(--spacing-6) 0;
    border-top: 1px solid var(--color-border);
    margin-top: var(--spacing-8);
  }

  .govuk-footer__meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
  }

  .govuk-button {
    padding: var(--spacing-2) var(--spacing-3);
    font-size: var(--font-size-19);
    font-weight: 700;
    background: var(--color-success);
    color: white;
    border: 2px solid var(--color-success);
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
  }

  .govuk-button:hover {
    background: #00572e;
    border-color: #00572e;
  }

  .govuk-button:focus {
    outline: var(--focus-width) solid var(--color-focus);
    outline-offset: 0;
    background-color: var(--color-focus);
    color: var(--color-text);
    border-color: var(--color-text);
  }

  .govuk-button--secondary {
    background: var(--color-bg-secondary);
    color: var(--color-text);
    border-color: var(--color-text);
  }

  .govuk-button--secondary:hover {
    background: var(--color-text);
    color: var(--color-bg);
  }

  /* GOV.UK Utility Classes */
  .govuk-!-margin-bottom-1 { margin-bottom: var(--spacing-1) !important; }
  .govuk-!-margin-bottom-2 { margin-bottom: var(--spacing-2) !important; }
  .govuk-!-margin-bottom-3 { margin-bottom: var(--spacing-3) !important; }
  .govuk-!-margin-bottom-4 { margin-bottom: var(--spacing-4) !important; }
  .govuk-!-margin-bottom-6 { margin-bottom: var(--spacing-6) !important; }
  .govuk-!-margin-bottom-7 { margin-bottom: var(--spacing-7) !important; }
  .govuk-!-margin-bottom-8 { margin-bottom: var(--spacing-8) !important; }
  
  .govuk-!-margin-top-3 { margin-top: var(--spacing-3) !important; }
  
  .govuk-!-margin-left-3 { margin-left: var(--spacing-3) !important; }
  .govuk-!-margin-right-3 { margin-right: var(--spacing-3) !important; }
  
  .govuk-!-font-weight-bold { font-weight: 700 !important; }
  
  .govuk-text-colour--secondary { 
    color: var(--color-text-secondary) !important; 
  }

  .govuk-grid-row {
    display: flex;
    flex-wrap: wrap;
    margin: 0 -15px;
  }

  .govuk-grid-column-one-half {
    padding: 0 15px;
    width: 50%;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .govuk-heading-xl {
      font-size: var(--font-size-36);
    }

    .govuk-heading-l {
      font-size: var(--font-size-27);
    }

    .govuk-heading-m {
      font-size: var(--font-size-19);
    }

    .govuk-body-l {
      font-size: var(--font-size-19);
    }

    .govuk-body {
      font-size: var(--font-size-16);
    }

    .govuk-grid-column-one-half {
      width: 100%;
    }

    .govuk-button-group {
      flex-direction: column;
      align-items: flex-start;
    }

    .govuk-button-group span {
      display: none;
    }

    .govuk-footer__meta {
      flex-direction: column;
      align-items: flex-start;
    }
  }

  /* Print styles */
  @media print {
    .govuk-skip-link,
    .govuk-button,
    .govuk-details__summary {
      display: none !important;
    }

    .govuk-details__text {
      display: block !important;
      border: none !important;
      padding-left: 0 !important;
    }

    .govuk-header {
      border-bottom: 2px solid black !important;
    }

    .govuk-tag {
      border: 1px solid black !important;
      background: white !important;
      color: black !important;
    }
  }
</style>